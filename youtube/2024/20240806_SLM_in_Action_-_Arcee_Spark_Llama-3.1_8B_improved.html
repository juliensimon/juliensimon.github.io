<!DOCTYPE html>

<html lang="en">
<head>
<meta content="SLM in Action   Arcee Spark Llama 3.1 8B improved - In this video, you will learn about Arcee-Spark, a new state-of-the-art 8-billion parameter model created by Arcee.ai from Llama-3.1 8B. 

⭐️⭐️⭐️ Don't forget t..." name="description"/><meta content="SLM in Action   Arcee Spark Llama 3.1 8B improved - Julien Simon" property="og:title"/><meta content="SLM in Action   Arcee Spark Llama 3.1 8B improved - In this video, you will learn about Arcee-Spark, a new state-of-the-art 8-billion parameter model created by Arcee.ai from Llama-3.1 8B. 

⭐️⭐️⭐️ Don't forget t..." property="og:description"/><meta content="https://www.julien.org/youtube/2024/20240806_SLM_in_Action_-_Arcee_Spark_Llama-3.1_8B_improved.html" property="og:url"/><meta content="video" property="og:type"/><meta content="summary_large_image" name="twitter:card"/><meta content="SLM in Action   Arcee Spark Llama 3.1 8B improved - Julien Simon" name="twitter:title"/><meta content="SLM in Action   Arcee Spark Llama 3.1 8B improved - In this video, you will learn about Arcee-Spark, a new state-of-the-art 8-billion parameter model created by Arcee.ai from Llama-3.1 8B. 

⭐️⭐️⭐️ Don't forget t..." name="twitter:description"/><link href="https://www.julien.org/youtube/2024/20240806_SLM_in_Action_-_Arcee_Spark_Llama-3.1_8B_improved.html" rel="canonical"/><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>SLM in Action   Arcee Spark Llama 3.1 8B improved - Julien Simon</title>
<style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.2em;
        }
        .date {
            color: #7f8c8d;
            font-size: 1.1em;
            margin-bottom: 30px;
            font-weight: 500;
        }
        .video-container {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            margin-bottom: 30px;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 8px;
        }
        .description {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            white-space: pre-wrap;
            font-size: 1em;
        }
        .description a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .description a:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        .transcript {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            white-space: pre-wrap;
            font-size: 1em;
        }
        .transcript h2 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .tags {
            margin-bottom: 30px;
        }
        .tags h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .tag {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 6px 12px;
            margin: 4px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
        }
        .links {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .link {
            display: inline-block;
            padding: 12px 24px;
            background: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        .link:hover {
            background: #2980b9;
        }
        .link.youtube {
            background: #e74c3c;
        }
        .link.youtube:hover {
            background: #c0392b;
        }
        @media (max-width: 600px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            h1 {
                font-size: 1.8em;
            }
            .links {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
<div class="container">
<h1>SLM in Action   Arcee Spark Llama 3.1 8B improved</h1>
<div class="date">August 06, 2024</div>
<div class="video-container">
<iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" src="https://www.youtube.com/embed/Mni0lx6Bf5s">
</iframe>
</div>
<div class="description">In this video, you will learn about Arcee-Spark, a new state-of-the-art 8-billion parameter model created by Arcee.ai from Llama-3.1 8B. 

⭐️⭐️⭐️ Don't forget to subscribe to be notified of future videos. Follow me on Medium at <a href="https://julsimon.medium.com" rel="noopener noreferrer" target="_blank">https://julsimon.medium.com</a> or Substack at <a href="https://julsimon.substack.com." rel="noopener noreferrer" target="_blank">https://julsimon.substack.com.</a> ⭐️⭐️⭐️

At the time of recording, Spark outperforms its base model on most language and math benchmarks.

The model is a merge of Llama-3.1 8B with additional training. It was built on Arcee Cloud and you can learn more at <a href="https://hubs.li/Q02KhKzK0" rel="noopener noreferrer" target="_blank">https://hubs.li/Q02KhKzK0</a>

Here, I first run a 5-bit quantized version on my M3 MacBook and ollama. Then, I deploy the model on AWS with Amazon SageMaker. I run both synchronous and streaming inference. I also show you how to use the OpenAI Messages API, allowing you to invoke the model with the OpenAI prompting format. Finally, I compare ChatGPT and Arcee-Spark, and explain the benefits of high-quality small language models like Arcee-Spark compared to closed models.

* Blog post: <a href="https://hubs.li/Q02KhY700" rel="noopener noreferrer" target="_blank">https://hubs.li/Q02KhY700</a>
* Model page (full precision model): <a href="https://www.youtube.com/redirect?event=video_description&amp;redir_token=QUFFLUhqbjVqLW9meGdqUHJIWUcwbHBMd1lnUktTaVlSUXxBQ3Jtc0ttT2NpNFpyNTB3QWx3Z0FoNWZjWDZoT1VEZk5oNXFOM1ZRZWFmZDlvRFVVMkxNMGlJRXROc3N3STViNi02Y3FvT0d2MkoxcERiM3MtbXpQM3BDd2l4aWdxRDVvQWhBRjFwNlpKUHI1N2hTN1pDbmxyZw&amp;q=https%3A%2F%2Fhuggingface.co%2Farcee-ai%2FLlama-Spark&amp;v=Mni0lx6Bf5s" rel="noopener noreferrer" target="_blank">https://www.youtube.com/redirect?event=video_description&amp;redir_token=QUFFLUhqbjVqLW9meGdqUHJIWUcwbHBMd1lnUktTaVlSUXxBQ3Jtc0ttT2NpNFpyNTB3QWx3Z0FoNWZjWDZoT1VEZk5oNXFOM1ZRZWFmZDlvRFVVMkxNMGlJRXROc3N3STViNi02Y3FvT0d2MkoxcERiM3MtbXpQM3BDd2l4aWdxRDVvQWhBRjFwNlpKUHI1N2hTN1pDbmxyZw&amp;q=https%3A%2F%2Fhuggingface.co%2Farcee-ai%2FLlama-Spark&amp;v=Mni0lx6Bf5s</a>
* Model page (quantized models): <a href="https://www.youtube.com/redirect?event=video_description&amp;redir_token=QUFFLUhqa2pleUUtUGJ0eTIxU0hoWUhEelYxNk1WTGdYd3xBQ3Jtc0ttbmZhX2xjQTVad0ZGbTRJR2lNcFRjalM3T3lGRVBZdGp4ZWFMbkhELVVXVVhyUTZCejlOdDFId0hMMm9MM1VDMVhMc0lxUXhrWTlQdTdNalhrTkw2VGxuY3hMQ1RUeE9EU21qYUl1ZG5CLWFXeU1EOA&amp;q=https%3A%2F%2Fhuggingface.co%2Farcee-ai%2FLlama-Spark-GGUF&amp;v=Mni0lx6Bf5s" rel="noopener noreferrer" target="_blank">https://www.youtube.com/redirect?event=video_description&amp;redir_token=QUFFLUhqa2pleUUtUGJ0eTIxU0hoWUhEelYxNk1WTGdYd3xBQ3Jtc0ttbmZhX2xjQTVad0ZGbTRJR2lNcFRjalM3T3lGRVBZdGp4ZWFMbkhELVVXVVhyUTZCejlOdDFId0hMMm9MM1VDMVhMc0lxUXhrWTlQdTdNalhrTkw2VGxuY3hMQ1RUeE9EU21qYUl1ZG5CLWFXeU1EOA&amp;q=https%3A%2F%2Fhuggingface.co%2Farcee-ai%2FLlama-Spark-GGUF&amp;v=Mni0lx6Bf5s</a>
* Dataset page: <a href="https://www.youtube.com/redirect?event=video_description&amp;redir_token=QUFFLUhqbm9uRThPaG4zd3BjdWNULXEtOXlncGZNaTV3QXxBQ3Jtc0tscXc3NEg4aWJSRHloMXQtQkwtazZ5UWUwcmdCRnNXN3FZM2JNazd6NFlPNS1zN3dpaDdJMUhjSFdwTnRIZi1DbEdjS1Y4SlRZLUZpLWRscVo2eUZzY2ExN0Fza05TOFpmOHZyd0hTbWN5R2xBVWpfMA&amp;q=https%3A%2F%2Fhuggingface.co%2Fdatasets%2Farcee-ai%2FThe-Tome&amp;v=Mni0lx6Bf5s" rel="noopener noreferrer" target="_blank">https://www.youtube.com/redirect?event=video_description&amp;redir_token=QUFFLUhqbm9uRThPaG4zd3BjdWNULXEtOXlncGZNaTV3QXxBQ3Jtc0tscXc3NEg4aWJSRHloMXQtQkwtazZ5UWUwcmdCRnNXN3FZM2JNazd6NFlPNS1zN3dpaDdJMUhjSFdwTnRIZi1DbEdjS1Y4SlRZLUZpLWRscVo2eUZzY2ExN0Fza05TOFpmOHZyd0hTbWN5R2xBVWpfMA&amp;q=https%3A%2F%2Fhuggingface.co%2Fdatasets%2Farcee-ai%2FThe-Tome&amp;v=Mni0lx6Bf5s</a>
* Notebook: <a href="https://www.youtube.com/redirect?event=video_description&amp;redir_token=QUFFLUhqa1AwM0RWYW1ocmdkeTRPV1VtdUs5VjNZZWRoQXxBQ3Jtc0tuMjVRZGtXaHBpRlo5aHFkSm0xLTRfdzBMWmlTdGM1SnZKbkoweDhDTnA0NF81TXNiaTUwSDlCWk1XVDJCekZQNk9qT0xrRDVldFpMOXJBcEx3VTVOUFROUC10d3JYc1lud0syQmtjczEyclBLTUE4cw&amp;q=https%3A%2F%2Fgitlab.com%2Fjuliensimon%2Farcee-demos%2F-%2Fblob%2Fmain%2Fsagemaker%2Fdeploy_spark_gpu.ipynb&amp;v=Mni0lx6Bf5s" rel="noopener noreferrer" target="_blank">https://www.youtube.com/redirect?event=video_description&amp;redir_token=QUFFLUhqa1AwM0RWYW1ocmdkeTRPV1VtdUs5VjNZZWRoQXxBQ3Jtc0tuMjVRZGtXaHBpRlo5aHFkSm0xLTRfdzBMWmlTdGM1SnZKbkoweDhDTnA0NF81TXNiaTUwSDlCWk1XVDJCekZQNk9qT0xrRDVldFpMOXJBcEx3VTVOUFROUC10d3JYc1lud0syQmtjczEyclBLTUE4cw&amp;q=https%3A%2F%2Fgitlab.com%2Fjuliensimon%2Farcee-demos%2F-%2Fblob%2Fmain%2Fsagemaker%2Fdeploy_spark_gpu.ipynb&amp;v=Mni0lx6Bf5s</a>
<a href="https://www.youtube.com/watch?v=Mni0lx6Bf5s&amp;t=0" rel="noopener noreferrer" target="_blank">00:00</a> Introduction
<a href="https://www.youtube.com/watch?v=Mni0lx6Bf5s&amp;t=38" rel="noopener noreferrer" target="_blank">00:38</a> Introducing Arcee-Spark
<a href="https://www.youtube.com/watch?v=Mni0lx6Bf5s&amp;t=150" rel="noopener noreferrer" target="_blank">02:30</a> Running Arcee-Spark locally with ollama
<a href="https://www.youtube.com/watch?v=Mni0lx6Bf5s&amp;t=290" rel="noopener noreferrer" target="_blank">04:50</a> Deploying Arcee-Spark on AWS with Amazon SageMaker
<a href="https://www.youtube.com/watch?v=Mni0lx6Bf5s&amp;t=455" rel="noopener noreferrer" target="_blank">07:35</a> Running inference with Arcee-Spark on Amazon SageMaker
<a href="https://www.youtube.com/watch?v=Mni0lx6Bf5s&amp;t=625" rel="noopener noreferrer" target="_blank">10:25</a> Arcee-Spark vs. ChatGPT
<a href="https://www.youtube.com/watch?v=Mni0lx6Bf5s&amp;t=805" rel="noopener noreferrer" target="_blank">13:25</a> Why small language models make more sense than closed models!

Configuration file for ollama:
FROM ./llama-spark-dpo-v0.3-Q5_K_S.gguf

#ai #aws #slm #llm #openai #chatgpt #opensource #huggingface

Sign up for Arcee Cloud at <a href="https://hubs.li/Q02Kh_YQ0" rel="noopener noreferrer" target="_blank">https://hubs.li/Q02Kh_YQ0</a> and please follow Arcee.ai on LinkedIn to stay on top of the latest Small Language Model action!</div>
<div class="transcript">
<h2>Transcript</h2>
            Hi everybody, this is Julien from Arcee. Last week we released Lama Spark, a new Lama 3.1 variant that outperforms the original model. In this video, I'm going to talk a little bit about the model and how we built it, and then we'll test it locally on my machine with O-Lama, and then we'll deploy it on Amazon SageMaker on a small GPU instance, and we'll run some testing. You will see why this model, just like small language models in general, are a great alternative to OpenAI models. Let's get started.

Lama Spark is a variant of Lama 3.1, 8 billion. We started from the base model, fine-tuned it on the Tome dataset, which Arcee released a little while ago. Then we merged that fine-tuned model with the Instruct version of Lama 3.1.8b. The results are pretty good. You can look at how Lama Spark outperforms Lama 3.1.8b Instruct on a lot of different tasks. The model is available on Hugging Face, and you can find more information in the blog post. We also have GGUF and quantized versions available for local inference. Last but not least, we have the dataset that was used to fine-tune the LAMA 3.1 base model. It's called the TOME, a fairly large dataset with 1.75 million rows, and you can read all about it.

Now let's grab a quantized version of Lama Spark and run it on my Mac. Lama Spark is an 8 billion parameter model, so there's no need to go to extreme quantization. I went for Q5AS, which is a very good compromise between model size and accuracy. You just need to go here, and you see the model parameters, and just click on the download link. I've done that already. The model file is just a little over 5 gigs, which should be very easy to run on this machine. Using a simple config file like this, I could just go and run `olama create`. Now we have our model ready to go. We can just run it. Let's ask a question. How about that? Is there a relationship between transformer robots and transformer models? There's actually a connection. Interesting. Okay. And you can see how fast this is. Running smaller models, particularly quantized versions on a local machine, is just super sweet. The speed is very good. If you have a good laptop or machine, you can do this all day.

How can I optimize inference latency in the KV cache? Let's see. Quantization, pruning, distillation, and so on. Very detailed answers, very good speed. What's not to like? You can run local inference all day. But chances are, for production, you want to run in a different environment. So now let me show you how we can run this on AWS, and we'll see how you could actually migrate from OpenAI to this with minimal impact.

In this notebook, we're going to deploy Lama Spark on AWS using Amazon SageMaker. I'll use a really small GPU instance, which is cost-efficient, and we'll run some prompts. Model deployment is very easy. First, define the name of the model and then define some parameters, such as the maximum input for the model. Arcee Spark has a large context window. You can go all the way to 128, which is much more than the original LAMA. However, this is limited by GPU RAM. On this small instance, I can't go higher than 8K, which is more than enough for a lot of use cases. But if you need to work with a bigger context, you will need an accelerator with more RAM. So max input will be 8K, total tokens, so input plus output, I've set this to 10K, but you could tweak it. You could have a higher input context and a lower output if you just want short answers. 8K will be more than enough here.

I'll enable the messages API, which sets OpenAI compatibility for inference. SageMaker uses the Hugging Face text generation inference server, allowing you to send inference requests and receive answers using the OpenAI format. This really simplifies the whole thing. Then we create a model object using the SageMaker SDK, get the name of the Docker image for the TGI server, and call `deploy` using a small G5 instance, which costs about $1.2 an hour on-demand. It takes a few minutes to deploy, and now we can run inference. We can use the OpenAI prompting format, which hides the complexity of the LAMA prompting format. Just define the model as TGI, the system prompt, the user prompt, and the max tokens. Let's run this and do synchronous inference. Generating the full answer in one go and then sending it back. And then we should be able to print it. So we have the answer. It's in the OpenAI format, a long answer with the number of tokens, etc. And we can print it nicely because it's a markdown answer. Pretty cool stuff.

But probably what you want is streaming inference, a nice chatbot experience. I took some support code from an AWS blog post to display the streaming response and tweaked it a little for the OpenAI format. Now I can run a streaming inference request. Same question, except I'm setting `stream` to true. Let's run this and invoke the SageMaker endpoint with a streaming response. Now we are streaming, a much nicer experience. The speed is just fine, and keep in mind, this is not a quantized model. It's generating fast enough on that small GPU instance. We get the same answer. It's very easy to work with these models on AWS. Just deploy them, run inference, and you're on your way.

One question you may have is how this model performs compared to ChatGPT. I ran a small query on ChatGPT just an hour ago and asked a simple question: Is Cybertron the ancestor of deep learning? The answer was that Cybertron is most commonly associated with the fictional planet from the Transformers franchise, not with deep learning or artificial intelligence. If there is any connection, it might be through a misinterpretation. It's not a great answer. ChatGPT is dodging the question, spitting out a full page of deep learning history, which is not what I wanted. This is a media-trained version of ChatGPT, a technique called block and breach.

Let's ask the same question to our LamaSpark model. The answer is not really better. It tells me a little more about what Cybertron is and a little bit about deep learning, but it's still not great. So what do we do next? We use external context. I'm not going to do a full Arcee demo, just simulate something. I took the history section of the Wikipedia page for machine learning and loaded it into a file. Now I'm passing this as context. Same question, but using the provided context. Cybertron is not the ancestor of deep learning. The term Cybertron refers to a learning machine developed by the Ritheon company in the early 60s. Cybertron was used to analyze Sornos signals, electrocardiograms, and speech patterns, etc. That's the answer I was looking for.

Some of you might say that if you pass the same context to ChatGPT, it would have figured it out. I agree. My point is, why work with a really large model that you have little control over, that's next to impossible to fine-tune, and that can get expensive when scaling? If these models don't know everything, and no model knows everything, why not use a smaller, cost-efficient model that you can fine-tune, align, and host on your AWS infrastructure completely privately? You can add context to make it super relevant to your business domain. Those models do not know everything, and the only way to get high relevance is by adding external context. If you have a great open-source model to write a good story based on that context, even better. I can only think of the benefits.

That's pretty much what I wanted to show you today. Lama Spark, a new state-of-the-art Lama 3.1, is very easy to test on your local machine and deploy on your AWS infrastructure. You can use the OpenAI prompting format, so you don't have to rewrite your application code. It gives you really good answers out of the box, and if you add your own domain-specific context, it gets even better. So SLMs for the win. Count on me to keep diving into that area. Much more content coming. You know what to do, my friends. Keep rocking.
        </div>
<div class="tags">
<h2>Tags</h2>
<span class="tag">Lama Spark</span><span class="tag">Model Deployment</span><span class="tag">AWS SageMaker</span><span class="tag">Local Inference</span><span class="tag">Quantization</span>
</div>
<div class="links"><a class="link" href="../../index.html">← Back to YouTube Overview</a></div>
</div>
</body>
</html>