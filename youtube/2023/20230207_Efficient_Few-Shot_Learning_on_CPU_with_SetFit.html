<!DOCTYPE html>

<html lang="en">
<head>
<meta content="Efficient Few Shot Learning on CPU with SetFit - In this video, I'm using SetFit, an open source library for few-shot learning to train a text classification model from only 16 labeled samples. In less than 2...." name="description"/><meta content="Efficient Few Shot Learning on CPU with SetFit - Julien Simon" property="og:title"/><meta content="Efficient Few Shot Learning on CPU with SetFit - In this video, I'm using SetFit, an open source library for few-shot learning to train a text classification model from only 16 labeled samples. In less than 2...." property="og:description"/><meta content="https://www.julien.org/youtube/2023/20230207_Efficient_Few-Shot_Learning_on_CPU_with_SetFit.html" property="og:url"/><meta content="video" property="og:type"/><meta content="summary_large_image" name="twitter:card"/><meta content="Efficient Few Shot Learning on CPU with SetFit - Julien Simon" name="twitter:title"/><meta content="Efficient Few Shot Learning on CPU with SetFit - In this video, I'm using SetFit, an open source library for few-shot learning to train a text classification model from only 16 labeled samples. In less than 2...." name="twitter:description"/><link href="https://www.julien.org/youtube/2023/20230207_Efficient_Few-Shot_Learning_on_CPU_with_SetFit.html" rel="canonical"/><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Efficient Few Shot Learning on CPU with SetFit - Julien Simon</title>
<style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.2em;
        }
        .date {
            color: #7f8c8d;
            font-size: 1.1em;
            margin-bottom: 30px;
            font-weight: 500;
        }
        .video-container {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            margin-bottom: 30px;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 8px;
        }
        .description {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            white-space: pre-wrap;
            font-size: 1em;
        }
        .description a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .description a:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        .transcript {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            white-space: pre-wrap;
            font-size: 1em;
        }
        .transcript h2 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .tags {
            margin-bottom: 30px;
        }
        .tags h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .tag {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 6px 12px;
            margin: 4px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
        }
        .links {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .link {
            display: inline-block;
            padding: 12px 24px;
            background: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        .link:hover {
            background: #2980b9;
        }
        .link.youtube {
            background: #e74c3c;
        }
        .link.youtube:hover {
            background: #c0392b;
        }
        @media (max-width: 600px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            h1 {
                font-size: 1.8em;
            }
            .links {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
<div class="container">
<h1>Efficient Few Shot Learning on CPU with SetFit</h1>
<div class="date">February 07, 2023</div>
<div class="video-container">
<iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" src="https://www.youtube.com/embed/3uOXG01mcUQ">
</iframe>
</div>
<div class="description">In this video, I'm using SetFit, an open source library for few-shot learning to train a text classification model from only 16 labeled samples. In less than 2.5 minutes of CPU training, I get an accuracy of 94.5% :)

⭐️⭐️⭐️ Don't forget to subscribe to be notified of future videos ⭐️⭐️⭐️
 

- Blog post: <a href="https://huggingface.co/blog/setfit" rel="noopener noreferrer" target="_blank">https://huggingface.co/blog/setfit</a>
- Code: <a href="https://gist.github.com/juliensimon/4c77ec7ed44587aaf5666fe95e0dbec2" rel="noopener noreferrer" target="_blank">https://gist.github.com/juliensimon/4c77ec7ed44587aaf5666fe95e0dbec2</a>
- Setfit: <a href="https://huggingface.co/blog/setfit" rel="noopener noreferrer" target="_blank">https://huggingface.co/blog/setfit</a>
- Intel Sapphire Rapids: <a href="https://en.wikipedia.org/wiki/Sapphire_Rapids" rel="noopener noreferrer" target="_blank">https://en.wikipedia.org/wiki/Sapphire_Rapids</a>
- Intel Advanced Matrix Entensions: <a href="https://en.wikipedia.org/wiki/Advanced_Matrix_Extensions" rel="noopener noreferrer" target="_blank">https://en.wikipedia.org/wiki/Advanced_Matrix_Extensions</a> 
- Amazon EC2 R7iz: <a href="https://aws.amazon.com/ec2/instance-types/r7iz" rel="noopener noreferrer" target="_blank">https://aws.amazon.com/ec2/instance-types/r7iz</a></div>
<div class="transcript">
<h2>Transcript</h2>
            Hi everybody, this is Julien from Arcee. Training deep learning models means having a dataset, and that usually means labeling data. Deep learning models are really data hungry, so we need lots of data, lots of labeled data, and that's time-consuming and expensive, not so fun to do. What if we could actually train models with just a tiny bit of labeled data? And when I say a tiny bit, I mean really a handful of data instances. This is exactly what you can do with the SetFit library. Bring in just a few labeled samples and get really good results with very short training times. In fact, training times are so short that you can consider training on CPU. I've been a little bit obsessed with those new Intel CPUs lately. Of course, we're going to train with SetFit on Intel CPUs. You'll see it'll only take minutes, and we're going to get extremely good results.

To begin with, you should really read the SetFit blog post, which has a lot of interesting information. In a nutshell, SetFit is an open-source library that lets you train sentence transformer models for text classification using few-shot learning. So with just a few labeled samples. The mile-high view is really that you start from that tiny bit of data. Let's say positive and negative sentiment data. SetFit will generate a certain number of sentence pairs, so positive and negative, to learn the difference between those two classes. It's called contrastive learning. First, the model will be automatically fine-tuned on those sentence pairs. The intuition is, we want to understand how a positive sentence is different from a negative sentence. So we'll fine-tune the embeddings here. Then we will actually encode the sentences in the dataset with the fine-tuned Sentence Transformer model. That will give us embeddings, and we can use that to train the actual classification layer. Start with a little bit of data, learn the differences, fine-tune a model, and then use that model to train a classifier. Pretty cool. And the code is dead simple. Why don't we look at that?

Here's a very simple example, adapted from the blog post. I experimented with different datasets and went for the Yelp polarity dataset. It's a set of reviews from Yelp, obviously, and it has two classes, positive and negative, and they're really strong, polarized reviews. I thought, well, that should work pretty well with few-shot learning. I'm only grabbing eight reviews from each class. As you can see here, I'm using the full test set. Then I'm downloading a sentence transformer model from the hub. We have this SetFit model API, which is very familiar. Thank you, library creators. We have a SetFit trainer object, which will feel very familiar. Passing the model, the training set, the evaluation set, the metric, the loss class we want to use, the batch size, and the number of iterations and the number of epochs. I'll just fine-tune for one single epoch. All right, so that's simple enough. Then I just call train and then call evaluate and then print the metrics. Yes, as mentioned before, I am running this on a Sapphire Rapids Intel instance on AWS. We've seen this before, but we see we have the AMX support enabled, so the advanced matrix extensions that accelerate matrix multiply and accumulate, which certainly we're going to run during the training step. Let's just run this code, and it should be fast.

The original dataset is actually 560,000 reviews. I'm just taking eight. Then I'm using the full test set. So that's my dataset, the actual one. Now it's training. You can see one epoch will last just a little bit less than three minutes. Why go and fire up a GPU for this? It's fast enough, right? You can run it on any machine that you have laying around. So that's pretty cool. Let's just wait for this to complete and then we'll see what accuracy we get. Once evaluation is done, we see accuracy is a very nice 94.5% with 2 minutes and 19 seconds of training. What else can I say? SetFit is very impressive, and I really encourage you to give it a try. It looks like it gets very sweet results with just a tiny bit of data. You could very well save yourself a world of trouble by just working with a tiny bit of data. And of course, you're going to work with CPU servers, which are my favorite. They're easier to manage, generally less expensive as well. So yeah, it looks like we have a good combination of SetFit and CPU, so I'll keep digging. That's it for today. I hope this was fun and informative. I'll see you soon with more content. Next time, keep rocking.
        </div>
<div class="tags">
<h2>Tags</h2>
<span class="tag">SetFit</span><span class="tag">Few-shot Learning</span><span class="tag">Sentence Transformers</span><span class="tag">Intel CPU</span><span class="tag">Yelp Polarity Dataset</span>
</div>
<div class="links"><a class="link" href="../../youtube.html">← Back to YouTube Overview</a></div>
</div>
</body>
</html>