<!DOCTYPE html>

<html lang="en">
<head>
<meta content="Amazon SageMaker Studio   Managed Spot Training - In this video, I show you how to use Managed Spot Training to save a ton on money on your training jobs.

* Notebook: https://github.com/juliensimon/amazon-stud..." name="description"/><meta content="Amazon SageMaker Studio   Managed Spot Training - Julien Simon" property="og:title"/><meta content="Amazon SageMaker Studio   Managed Spot Training - In this video, I show you how to use Managed Spot Training to save a ton on money on your training jobs.

* Notebook: https://github.com/juliensimon/amazon-stud..." property="og:description"/><meta content="https://www.julien.org/youtube/2019/20191212_Amazon_SageMaker_Studio_-_Managed_Spot_Training.html" property="og:url"/><meta content="video" property="og:type"/><meta content="summary_large_image" name="twitter:card"/><meta content="Amazon SageMaker Studio   Managed Spot Training - Julien Simon" name="twitter:title"/><meta content="Amazon SageMaker Studio   Managed Spot Training - In this video, I show you how to use Managed Spot Training to save a ton on money on your training jobs.

* Notebook: https://github.com/juliensimon/amazon-stud..." name="twitter:description"/><link href="https://www.julien.org/youtube/2019/20191212_Amazon_SageMaker_Studio_-_Managed_Spot_Training.html" rel="canonical"/><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Amazon SageMaker Studio   Managed Spot Training - Julien Simon</title>
<style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.2em;
        }
        .date {
            color: #7f8c8d;
            font-size: 1.1em;
            margin-bottom: 30px;
            font-weight: 500;
        }
        .video-container {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            margin-bottom: 30px;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 8px;
        }
        .description {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            white-space: pre-wrap;
            font-size: 1em;
        }
        .description a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .description a:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        .transcript {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            white-space: pre-wrap;
            font-size: 1em;
        }
        .transcript h2 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .tags {
            margin-bottom: 30px;
        }
        .tags h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .tag {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 6px 12px;
            margin: 4px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
        }
        .links {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .link {
            display: inline-block;
            padding: 12px 24px;
            background: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        .link:hover {
            background: #2980b9;
        }
        .link.youtube {
            background: #e74c3c;
        }
        .link.youtube:hover {
            background: #c0392b;
        }
        @media (max-width: 600px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            h1 {
                font-size: 1.8em;
            }
            .links {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
<div class="container">
<h1>Amazon SageMaker Studio   Managed Spot Training</h1>
<div class="date">December 12, 2019</div>
<div class="video-container">
<iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" src="https://www.youtube.com/embed/jH7X5jSmVPU">
</iframe>
</div>
<div class="description">In this video, I show you how to use Managed Spot Training to save a ton on money on your training jobs.

* Notebook: <a href="https://gitlab.com/juliensimon/amazon-studio-demos/blob/master/spot-training.ipynb" rel="noopener noreferrer" target="_blank">https://gitlab.com/juliensimon/amazon-studio-demos/blob/master/spot-training.ipynb</a>
* SageMaker SDK: <a href="https://sagemaker.readthedocs.io/" rel="noopener noreferrer" target="_blank">https://sagemaker.readthedocs.io/</a>
* Blog post: <a href="https://aws.amazon.com/blogs/aws/managed-spot-training-save-up-to-90-on-your-amazon-sagemaker-training-jobs/" rel="noopener noreferrer" target="_blank">https://aws.amazon.com/blogs/aws/managed-spot-training-save-up-to-90-on-your-amazon-sagemaker-training-jobs/</a>

Follow me on: 
* Medium: <a href="https://medium.com/@julsimon" rel="noopener noreferrer" target="_blank">https://medium.com/@julsimon</a> 
* Twitter: <a href="https://twitter.com/julsimon" rel="noopener noreferrer" target="_blank">https://twitter.com/julsimon</a></div>
<div class="transcript">
<h2>Transcript</h2>
            Hi, Julien from Arcee here. In this video, I'd like to talk about Spot Training for Amazon SageMaker. You may be familiar with Spot Training on Amazon EC2. Spot is basically unused capacity in EC2 that you can use at a deep discounted price. The same feature is now available on Amazon SageMaker and has been for several months. However, I'm always surprised to meet customers who haven't heard about it, so it's such an important feature in saving money on your training jobs that I think it's worthy of a video. Let me show you how this works.

First, let's quickly recap how we train on SageMaker. We use an estimator object from the SageMaker SDK. Here, I'm using the TensorFlow estimator, passing the location of a script and specifying how much infrastructure I want to train on. For example, I want to use a C5.2xlarge instance and can pass hyperparameters and more. This is the default way of training, and we're going to fire up that C5.2xlarge instance on demand. This means we're going to pay the on-demand price, which is listed on the SageMaker pricing page. The managed instance starts, SageMaker will configure it, pull the TensorFlow container, inject your script, load your data, and training starts. This specific job lasted 777 seconds, which is about 13 or 14 minutes, and we're billed for the exact number of seconds used for that specific job. You know exactly how much you're going to pay because you know the on-demand price for that instance type.

Of course, if there's a less expensive way to do it, let's look at it. It's called managed spot training. This has been available on EC2 for years, and people have found many clever ways to leverage spot instances on EC2. It's super easy to use on SageMaker. Starting from the same estimator, and again, I'm using TensorFlow here, but it would be the same for built-in algorithms or other frameworks. It works for single instance training, distributed training, and hyperparameter tuning. All configurations are supported. The only thing you need to do is add these three parameters to your estimator. If you want to find out more, you can go to the SageMaker SDK documentation. I'll put the URL in the description. Here are the parameters: `train_use_spot_instances`, `train_max_run`, and `train_max_wait`.

The first parameter is obvious: `train_use_spot_instances=True`. The other two are important and might be a little confusing, so let me explain. `train_max_run` is the maximum training time for that specific job. For example, you don't want that job to run for more than half an hour, so you set it to 1800 seconds. `train_max_wait` is the total duration of the job, including the training time and any additional time you're willing to wait for spot instances. You might wait a few minutes or more for spot instances to be available. `train_max_wait` lets you cap the amount of time you're willing to wait for spot instances to be available. For example, if they're not available after half an hour, you might default to using on-demand instances.

So, use these three parameters: use spot instances, set how long the job should run, and how long you're willing to wait for spot instances. Then call `fit` as usual. If we scroll all the way down to the training log, we see the training time is 795 seconds, which is close to the previous training time. It seems we didn't wait long for spot instances, maybe just a few seconds. The billable seconds are what matter because these show up on your AWS bill. You will only be billed for 183 seconds, meaning you saved 77% of your training cost. That's a significant savings, especially if you train frequently and run distributed training or hyperparameter tuning.

If you're used to working with EC2 instances, you won't see these savings in the EC2 console because SageMaker instances are fully managed and not visible in EC2. Now, what's the catch? If we give you a 77% discount, there must be a catch. As with spot instances on EC2, we might have to reclaim that capacity at any given time for on-demand workloads. On EC2, you get a notification and two minutes to shut down your instance before we take it away. People who've worked with EC2 for a long time know how to handle this. On SageMaker, it's much simpler. If we have to reclaim capacity, your training job will be interrupted, and SageMaker will restart it automatically. If you use checkpointing, which saves the model in training at periodic intervals, SageMaker will restart from the latest checkpoint. Some built-in algorithms support checkpointing; refer to the SageMaker documentation. TensorFlow supports checkpointing by default, so there's nothing to do. For other libraries like MXNet, PyTorch, or Keras, you just need to enable checkpointing, which is often a simple parameter setting or a bit of coding.

When would you not use spot instances? If you have very long-running training jobs that cannot checkpoint for some reason, it might be better to use on-demand instances. If your job gets interrupted, you'll restart from scratch, which can be costly and frustrating. However, for everything else, give spot instances a try because 77% savings or more, depending on the instance type, is a compelling proposition.

If you want to know more, please take a look at the SageMaker SDK documentation and read the blog post I wrote when this feature came out. I'll put all those URLs in the description. That's it for spot training. I'll see you soon for other cool SageMaker features. See you.
        </div>
<div class="tags">
<h2>Tags</h2>
<span class="tag">Amazon SageMaker</span><span class="tag">Spot Training</span><span class="tag">Cost Saving</span><span class="tag">Machine Learning</span><span class="tag">AWS EC2 Spot Instances</span>
</div>
<div class="links"><a class="link" href="../../../youtube.html">← Back to YouTube Overview</a></div>
</div>
</body>
</html>