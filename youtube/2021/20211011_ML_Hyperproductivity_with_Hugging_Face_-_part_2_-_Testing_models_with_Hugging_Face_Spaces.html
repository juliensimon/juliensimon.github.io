<!DOCTYPE html>

<html lang="en">
<head>
<meta content="ML Hyperproductivity with Hugging Face   part 2   Testing models with Hugging Face Spaces - In part 1 (https://youtu.be/s-6V6HlwX98), I used AutoNLP, an AutoML product designed by Hugging Face to train a sentiment analysis model. 

In this video, I sho..." name="description"/><meta content="ML Hyperproductivity with Hugging Face   part 2   Testing models with Hugging Face Spaces - Julien Simon" property="og:title"/><meta content="ML Hyperproductivity with Hugging Face   part 2   Testing models with Hugging Face Spaces - In part 1 (https://youtu.be/s-6V6HlwX98), I used AutoNLP, an AutoML product designed by Hugging Face to train a sentiment analysis model. 

In this video, I sho..." property="og:description"/><meta content="https://www.julien.org/youtube/2021/20211011_ML_Hyperproductivity_with_Hugging_Face_-_part_2_-_Testing_models_with_Hugging_Face_Spaces.html" property="og:url"/><meta content="video" property="og:type"/><meta content="summary_large_image" name="twitter:card"/><meta content="ML Hyperproductivity with Hugging Face   part 2   Testing models with Hugging Face Spaces - Julien Simon" name="twitter:title"/><meta content="ML Hyperproductivity with Hugging Face   part 2   Testing models with Hugging Face Spaces - In part 1 (https://youtu.be/s-6V6HlwX98), I used AutoNLP, an AutoML product designed by Hugging Face to train a sentiment analysis model. 

In this video, I sho..." name="twitter:description"/><link href="https://www.julien.org/youtube/2021/20211011_ML_Hyperproductivity_with_Hugging_Face_-_part_2_-_Testing_models_with_Hugging_Face_Spaces.html" rel="canonical"/><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>ML Hyperproductivity with Hugging Face   part 2   Testing models with Hugging Face Spaces - Julien Simon</title>
<style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.2em;
        }
        .date {
            color: #7f8c8d;
            font-size: 1.1em;
            margin-bottom: 30px;
            font-weight: 500;
        }
        .video-container {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            margin-bottom: 30px;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 8px;
        }
        .description {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            white-space: pre-wrap;
            font-size: 1em;
        }
        .description a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .description a:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        .transcript {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            white-space: pre-wrap;
            font-size: 1em;
        }
        .transcript h2 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .tags {
            margin-bottom: 30px;
        }
        .tags h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .tag {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 6px 12px;
            margin: 4px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
        }
        .links {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .link {
            display: inline-block;
            padding: 12px 24px;
            background: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        .link:hover {
            background: #2980b9;
        }
        .link.youtube {
            background: #e74c3c;
        }
        .link.youtube:hover {
            background: #c0392b;
        }
        @media (max-width: 600px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            h1 {
                font-size: 1.8em;
            }
            .links {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
<div class="container">
<h1>ML Hyperproductivity with Hugging Face   part 2   Testing models with Hugging Face Spaces</h1>
<div class="date">October 11, 2021</div>
<div class="video-container">
<iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" src="https://www.youtube.com/embed/1JVm8yIbEqU">
</iframe>
</div>
<div class="description">In part 1 (<a href="https://youtu.be/s-6V6HlwX98)," rel="noopener noreferrer" target="_blank">https://youtu.be/s-6V6HlwX98),</a> I used AutoNLP, an AutoML product designed by Hugging Face to train a sentiment analysis model. 

In this video, I show you how to quickly build a small web app to test and demo your model, and how to host it on Hugging Face Spaces.

⭐️⭐️⭐️ Don't forget to subscribe to be notified of future videos ⭐️⭐️⭐️

<a href="https://huggingface.co/autonlp" rel="noopener noreferrer" target="_blank">https://huggingface.co/autonlp</a>
<a href="https://huggingface.co/spaces" rel="noopener noreferrer" target="_blank">https://huggingface.co/spaces</a>

Code: <a href="https://github.com/juliensimon/huggingface-demos/tree/main/imdb-sentiment-analysis" rel="noopener noreferrer" target="_blank">https://github.com/juliensimon/huggingface-demos/tree/main/imdb-sentiment-analysis</a>

New to Transformers? Check out the Hugging Face course at <a href="https://huggingface.co/course" rel="noopener noreferrer" target="_blank">https://huggingface.co/course</a></div>
<div class="transcript">
<h2>Transcript</h2>
            Hi, everybody. This is Julien from Arcee. In a previous video, we used AutoNLP to fine-tune models on a movie review dataset to build a sentiment analysis application. After a little while, we got a pretty good model with 94.08 accuracy. We took a look at this model on the hub, and I quickly showed you we could deploy it in different ways. Of course, we could use it with the Transformers library and run it in a notebook. But let's go one step further and build a prototype web app that uses this model. This way, we can show how the model works to business stakeholders or clients, and get feedback to iterate on. A web application gives a better sense of how the model works and what it could look like in an app, rather than showing them notebooks, which don't tell the full story.

So, how do we do this? First, I'm going to go to my HuggingFace account and create a new space. A space is a web app implemented with Streamlit or Gradio, displaying a user interface where we can enter data and predict with our model. It's very little code, which is great because I'm not good at writing front-end code. I'm hoping this is easy and friendly enough for me to use. I'm going to name this space "imdb emospace" and use Gradio, which I think is the simplest way. I can either make this public or private, so I'll keep it public and create the space.

We haven't done much so far; we've just created the space. Now, we need to add some code in a GitHub repo. Let's create this empty repo here. There's just a readme file, which doesn't say much. We need to add our code to the repo. There's a placeholder file here, and we can commit and push to see what happens. We can add dependencies with a requirements.txt file. In the interest of time, I've already written the code, so let me show you what it looks like. As promised, it's really simple.

We import PyTorch, NumPy, Gradio, and the Transformers library. Then we grab the tokenizer and the model from the hub. We write a small function to predict. This function will receive a movie review, tokenize it with the pre-trained tokenizer, predict using our model, and output raw predictions. I want to show probability-style results, so I apply the softmax function to make the two outputs for the positive and negative classes add up to 1, making them look like probabilities. After applying softmax, I convert the torch tensor to a NumPy array. Now I have a NumPy array with two numbers: the first for the negative class and the second for the positive class. I want the larger one, so I use NumPy's argmax to find the index of the largest number in the array and grab that score. Then I return a text string that says the review is XX% positive or negative, depending on the prediction.

This code is simple and can be tested on your laptop, completely independent of the UI. The only UI code needed is for creating an interface with two text boxes: one for input and one for output. The input will be the movie review, and clicking a button will call the predict function, displaying the prediction in the output window. That's it. Is this even UI code? Probably not, but I'm happy with it.

Let me copy this file to my repo. I also have a requirements file with Torch and Transformers. In this repo, I have these two new files. I'll add them, commit, and push. After maybe 30 seconds, the page is up and running. Let's try some reviews, starting with a negative one. I input the review, click submit, and the output window displays the result. Pretty cool. Let's try a positive one. If you think Jar Jar is the most amazing character in the Star Wars universe, it's okay. It's like the pineapple on pizza debate; it's fine if you believe it. This is a positive review, and we see the result.

We see our files here, and this is how much code we wrote. The predict function is something you'd already have if you were experimenting with your model, and the UI bit is just two lines. This is a cool way to build a quick web page to show stakeholders, customers, or for internal model testing. If you go to the huggingface.co spaces page, you'll find lots of public spaces built by the community. There are many cool examples, and I'm sure every single one looks better than my example, but you should be writing the great apps.

Remember how we started. We used AutoNLP, which is as simple as filling in a few bits of information or using the AutoNLP API for automation. We built models, took the best one, and used it in a notebook and more importantly, in Spaces to build a small web page to test it. The longest part was the NLP process, which took about two hours, but you can do other tasks in between, like writing the Spaces app. In just a couple of hours, you can go from dataset to a web page you can show. This is a productive way to do machine learning and NLP. Give it a try, leave comments, ask questions, and reach out on Twitter or anywhere you can find me. If your company wants to know more about AutoNLP for production workloads, get in touch. That's it for today. I'll see you soon with more videos. Until then, have a good time and keep learning. Bye-bye.
        </div>
<div class="tags">
<h2>Tags</h2>
<span class="tag">SentimentAnalysis</span><span class="tag">WebAppPrototype</span><span class="tag">Gradio</span><span class="tag">AutoNLP</span><span class="tag">ModelDeployment</span>
</div>
<div class="links"><a class="link" href="../../../youtube.html">← Back to YouTube Overview</a></div>
</div>
</body>
</html>