<!DOCTYPE html>
<html>
 <head>
    <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  
  <!-- Primary Meta Tags -->
  <title>Accelerating Protein Language Model ProtST On Intel Gaudi 2 - Julien Simon | Open Source AI Expert</title>
  <meta name="title" content="Accelerating Protein Language Model ProtST On Intel Gaudi 2 - Julien Simon | Open Source AI Expert"/>
  <meta name="description" content="Expert analysis and technical deep-dive on accelerating protein language model protst on intel gaudi 2 by Julien Simon, leading voice in open-source AI and former Chief Evangelist at Hugging Face. Comprehensive insights on transformers, small language models, and AI accessibility."/>
  <meta name="keywords" content="Hugging Face, Transformers, Open Source AI, Small Language Models, Machine Learning, AI, Natural Language Processing, NLP, Julien Simon, AI Expert, Open Source Expert, Hugging Face ExpertProtein-Language-Model-Protst-On-Intel-Gaudi-2, Accelerating Protein Language Model ProtST On Intel Gaudi 2"/>
  <meta name="author" content="Julien Simon"/>
  <meta name="robots" content="index, follow"/>
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article"/>
  <meta property="og:url" content="https://julien.org/blog/2024-07-03-accelerating-protein-language-model-protst-on-intel-gaudi-2/"/>
  <meta property="og:title" content="Accelerating Protein Language Model ProtST On Intel Gaudi 2 - Julien Simon | Open Source AI Expert"/>
  <meta property="og:description" content="Expert analysis and technical deep-dive on accelerating protein language model protst on intel gaudi 2 by Julien Simon, leading voice in open-source AI and former Chief Evangelist at Hugging Face. Comprehensive insights on transformers, small language models, and AI accessibility."/>
  <meta property="og:image" content="https://julien.org/assets/julien-simon-huggingface-expert.jpg"/>
  <meta property="og:site_name" content="Julien Simon - Open Source AI Expert"/>
  <meta property="article:author" content="Julien Simon"/>
  <meta property="article:published_time" content="2024-07-03T00:00:00Z"/>
  <meta property="article:section" content="Hugging Face"/>
  <meta property="article:tag" content="Hugging Face, Open Source AI, Transformers, Small Language Models"/>
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image"/>
  <meta property="twitter:url" content="https://julien.org/blog/2024-07-03-accelerating-protein-language-model-protst-on-intel-gaudi-2/"/>
  <meta property="twitter:title" content="Accelerating Protein Language Model ProtST On Intel Gaudi 2 - Julien Simon | Open Source AI Expert"/>
  <meta property="twitter:description" content="Expert analysis and technical deep-dive on accelerating protein language model protst on intel gaudi 2 by Julien Simon, leading voice in open-source AI and former Chief Evangelist at Hugging Face. Comprehensive insights on transformers, small language models, and AI accessibility."/>
  <meta property="twitter:image" content="https://julien.org/assets/julien-simon-huggingface-expert.jpg"/>
  <meta property="twitter:creator" content="@julsimon"/>
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://julien.org/blog/2024-07-03-accelerating-protein-language-model-protst-on-intel-gaudi-2/"/>
  
  <!-- Author and Publisher -->
  <link rel="author" href="https://julien.org/"/>
  <link rel="publisher" href="https://julien.org/"/>
  
  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Accelerating Protein Language Model ProtST On Intel Gaudi 2",
    "description": "Expert analysis and technical deep-dive on accelerating protein language model protst on intel gaudi 2 by Julien Simon, leading voice in open-source AI and former Chief Evangelist at Hugging Face. Comprehensive insights on transformers, small language models, and AI accessibility.",
    "image": "https://julien.org/assets/julien-simon-huggingface-expert.jpg",
    "author": {
      "@type": "Person",
      "name": "Julien Simon",
      "url": "https://julien.org/",
      "jobTitle": "Open Source AI Expert & Former Chief Evangelist",
      "worksFor": {
        "@type": "Organization",
        "name": "Hugging Face"
      },
      "sameAs": [
        "https://twitter.com/julsimon",
        "https://linkedin.com/in/juliensimon",
        "https://github.com/juliensimon"
      ]
    },
    "publisher": {
      "@type": "Organization",
      "name": "Julien Simon",
      "url": "https://julien.org/",
      "logo": {
        "@type": "ImageObject",
        "url": "https://julien.org/assets/julien-simon-logo.jpg"
      }
    },
    "datePublished": "2024-07-03T00:00:00Z",
    "dateModified": "2024-07-03T00:00:00Z",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://julien.org/blog/2024-07-03-accelerating-protein-language-model-protst-on-intel-gaudi-2/"
    },
    "url": "https://julien.org/blog/2024-07-03-accelerating-protein-language-model-protst-on-intel-gaudi-2/",
    "keywords": "Hugging Face, Transformers, Open Source AI, Small Language Models, Machine Learning, AI, Natural Language Processing, NLP, Julien Simon, AI Expert, Open Source Expert, Hugging Face Expert, Accelerating-Protein-Language-Model-Protst-On-Intel-Gaudi-2",
    "articleSection": "Hugging Face",
    "inLanguage": "en-US",
    "isPartOf": {
      "@type": "Blog",
      "name": "Julien Simon - Open Source AI Expert Blog",
      "url": "https://julien.org/blog/"
    }
  }
  </script>
  
  <!-- Additional SEO Meta Tags -->
  <meta name="twitter:site" content="@julsimon"/>
  <meta name="twitter:creator" content="@julsimon"/>
  <meta name="theme-color" content="#FF6B35"/>
  <meta name="msapplication-TileColor" content="#FF6B35"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
  
  <!-- Preconnect to external domains -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="https://julien.org/assets/favicon.ico">
  
  <!-- Security Headers -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
  <meta http-equiv="X-XSS-Protection" content="1; mode=block">
  <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=(), interest-cohort=()">
  <meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin">
  <meta http-equiv="Cross-Origin-Embedder-Policy" content="require-corp">

  
  <style>
   body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }
        h1, h2, h3, h4, h5, h6 {
            color: #2c3e50;
            margin-top: 2em;
            margin-bottom: 0.5em;
        }
        h1 { font-size: 2.5em; }
        h2 { font-size: 2em; }
        h3 { font-size: 1.5em; }
        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin: 1em 0;
        }
        /* Image alignment classes for text wraparound */
        img.alignleft {
            float: left;
            margin: 0.5em 1.5em 1em 0;
        }
        img.alignright {
            float: right;
            margin: 0.5em 0 1em 1.5em;
        }
        img.aligncenter {
            display: block;
            margin: 1em auto;
            float: none;
        }
        img.alignnone {
            float: none;
            margin: 1em 0;
        }
        /* Clear floats after images */
        .wp-block-image::after,
        p:has(img.alignleft)::after,
        p:has(img.alignright)::after {
            content: "";
            display: table;
            clear: both;
        }
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1em;
            overflow-x: auto;
        }
        code {
            background: #f8f9fa;
            padding: 0.2em 0.4em;
            border-radius: 3px;
            font-family: 'Monaco', 'Consolas', monospace;
        }
        blockquote {
            border-left: 4px solid #3498db;
            margin: 1em 0;
            padding-left: 1em;
            font-style: italic;
            color: #7f8c8d;
        }
        a {
            color: #3498db;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        p {
            margin-bottom: 1em;
        }
        /* Hugging Face specific styling */
        .prose {
            max-width: none;
        }
        .prose pre {
            background: #1e293b;
            color: #e2e8f0;
        }
        .prose code {
            background: #f1f5f9;
            color: #dc2626;
        }
  </style>
 </head>
 <body>

  <div style="margin-bottom: 2em;">
   <a href="../../../../huggingface-blog-posts.html" style="color: #3498db; text-decoration: none; font-weight: 500;">‚Üê Back to Hugging Face Blog Posts</a>
  </div>
  <h1>
   Accelerating Protein Language Model ProtST on Intel Gaudi 2
  </h1>
  <p style="color: #666; font-style: italic; margin-bottom: 1em;">
   Published: 2024-07-03
  </p>
  
  <p style="color: #666; font-style: italic; margin-bottom: 2em;">
   Originally published at
   <a href="https://huggingface.co/blog/intel-protein-language-model-protst">
    https://huggingface.co/blog/intel-protein-language-model-protst
   </a>
  </p>
  <!-- HTML_TAG_START -->
  <p align="center">
   <img alt="A teenage scientist creating molecules with computers and artificial intelligence" src="image01.webp" width="512"/>
   <br/>
  </p>
  <h2 class="relative group flex items-center">
   <span>
    Introduction
   </span>
  </h2>
  <p>
   Protein Language Models (PLMs) have emerged as potent tools for predicting and designing protein structure and function. At the International Conference on Machine Learning 2023 (ICML), MILA and Intel Labs released
   <a href="https://proceedings.mlr.press/v202/xu23t.html">
    ProtST
   </a>
   , a pioneering multi-modal language model for protein design based on text prompts. Since then, ProtST has been well-received in the research community, accumulating more than 40 citations in less than a year, showing the scientific strength of the work.
  </p>
  <p>
   One of PLM's most popular tasks is predicting the subcellular location of an amino acid sequence. In this task, users feed an amino acid sequence into the model, and the model outputs a label indicating the subcellular location of this sequence. Out of the box, zero-shot ProtST-ESM-1b outperforms state-of-the-art few-shot classifiers.
  </p>
  <kbd>
   <img src="image02.webp"/>
  </kbd>
  <p>
   To make ProtST more accessible, Intel and MILA have re-architected and shared the model on the Hugging Face Hub. You can download the models and datasets
   <a href="https://huggingface.co/mila-intel">
    here
   </a>
   .
  </p>
  <p>
   This post will show you how to run ProtST inference efficiently and fine-tune it with Intel Gaudi 2 accelerators and the Optimum for Intel Gaudi open-source library.
   <a href="https://habana.ai/products/gaudi2/">
    Intel Gaudi 2
   </a>
   is the second-generation AI  accelerator that Intel designed. Check out our
   <a href="https://huggingface.co/blog/habana-gaudi-2-bloom#habana-gaudi2">
    previous blog post
   </a>
   for an in-depth introduction and a guide to accessing it through the
   <a href="https://cloud.intel.com">
    Intel Developer Cloud
   </a>
   . Thanks to the
   <a href="https://github.com/huggingface/optimum-habana">
    Optimum for Intel Gaudi library
   </a>
   , you can port your transformers-based scripts to Gaudi 2 with minimal code changes.
  </p>
  <h2 class="relative group flex items-center">
   <span>
    Inference with ProtST
   </span>
  </h2>
  <p>
   Common subcellular locations include the nucleus, cell membrane, cytoplasm, mitochondria, and others as described in
   <a href="https://huggingface.co/datasets/mila-intel/subloc_template">
    this dataset
   </a>
   in greater detail.
  </p>
  <p>
   We compare ProtST's inference performance on NVIDIA A100 80GB PCIe and Gaudi 2 accelerator using the test split of the ProtST-SubcellularLocalization dataset. This test set contains 2772 amino acid sequences, with variable sequence lengths ranging from 79 to 1999.
  </p>
  <p>
   You can reproduce our experiment using
   <a href="https://github.com/huggingface/optimum-habana/tree/main/examples/protein-folding#single-hpu-inference-for-zero-shot-evaluation">
    this script
   </a>
   , where we run the model in full bfloat16 precision with batch size 1. We get an identical accuracy of 0.44 on the Nvidia A100 and Intel Gaudi 2, with Gaudi2 delivering 1.76x faster inferencing speed than the A100. The wall time for a single A100 and a single Gaudi 2 is shown in the figure below.
  </p>
  <kbd>
   <img src="image03.webp"/>
  </kbd>
  <h2 class="relative group flex items-center">
   <span>
    Fine-tuning ProtST
   </span>
  </h2>
  <p>
   Fine-tuning the ProtST model on downstream tasks is an easy and established way to improve modeling accuracy. In this experiment, we specialize the model for binary location, a simpler version of subcellular localization, with binary labels indicating whether a protein is membrane-bound or soluble.
  </p>
  <p>
   You can reproduce our experiment using
   <a href="https://github.com/huggingface/optimum-habana/tree/main/examples/protein-folding#multi-hpu-finetune-for-sequence-classification-task">
    this script
   </a>
   . Here, we fine-tune the
   <a href="https://huggingface.co/mila-intel/protst-esm1b-for-sequential-classification">
    ProtST-ESM1b-for-sequential-classification
   </a>
   model in bfloat16 precision on the
   <a href="https://huggingface.co/datasets/mila-intel/ProtST-BinaryLocalization">
    ProtST-BinaryLocalization
   </a>
   dataset.  The table below shows model accuracy on the test split with different training hardware setups, and they closely match the results published in the paper (around 92.5% accuracy).
  </p>
  <kbd>
   <img src="image04.webp"/>
  </kbd>
  <p>
   The figure below shows fine-tuning time. A single Gaudi 2 is 2.92x faster than a single A100. The figure also shows how distributed training scales near-linearly with 4 or 8 Gaudi 2 accelerators.
  </p>
  <kbd>
   <img src="image05.webp"/>
  </kbd>
  <h2 class="relative group flex items-center">
   <span>
    Conclusion
   </span>
  </h2>
  <p>
   In this blog post, we have demonstrated the ease of deploying ProtST inference and fine-tuning on Gaudi 2 based on Optimum for Intel Gaudi Accelerators. In addition, our results show competitive performance against A100, with a 1.76x speedup for inference and a 2.92x speedup for fine-tuning.
The following resources will help you get started with your models on the Intel Gaudi 2 accelerator:
  </p>
  <ul>
   <li>
    Optimum for Intel Gaudi Accelerators
    <a href="https://github.com/huggingface/optimum-habana">
     repository
    </a>
   </li>
   <li>
    Intel Gaudi
    <a href="https://docs.habana.ai/en/latest/index.html">
     documentation
    </a>
   </li>
  </ul>
  <p>
   Thank you for reading! We look forward to seeing your innovations built on top of ProtST with Intel Gaudi 2 accelerator capabilities.
  </p>
  <!-- HTML_TAG_END -->
 </body>
</html>
