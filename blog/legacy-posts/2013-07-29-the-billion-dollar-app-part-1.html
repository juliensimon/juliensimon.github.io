<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Legacy blog post by Julien Simon">
  <meta name="author" content="Julien Simon">
  <meta name="robots" content="index, follow">
  
  <title>The Billion Dollar App Part 1 â€“ Julien Simon</title>
  
  <!-- Umami Analytics -->
  <script>
    window.addEventListener('load', function() {
      var script = document.createElement('script');
      script.src = 'https://cloud.umami.is/script.js';
      script.setAttribute('data-website-id', '27550dad-d418-4f5d-ad1b-dab573da1020');
      document.head.appendChild(script);
    });
  </script>
  
  <!-- Resource hints for faster DNS resolution and connections -->
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="dns-prefetch" href="//fonts.gstatic.com">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
  <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"></noscript>
  
  <!-- Styles -->
  <link rel="stylesheet" href="../../css/styles.css">
  <link rel="stylesheet" href="../../css/social-icons.css">
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="../../assets/favicon.ico">
  
  <!-- Legacy post specific styles -->
  <style>
    .legacy-post-container {
      max-width: 800px;
      margin: 0 auto;
      padding: var(--space-6);
      background: var(--background);
      border-radius: 12px;
      box-shadow: var(--shadow-lg);
    }
    
    .legacy-post-header {
      text-align: center;
      margin-bottom: var(--space-8);
      padding-bottom: var(--space-6);
      border-bottom: 2px solid var(--border);
    }
    
    .legacy-post-title {
      font-size: var(--text-3xl);
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: var(--space-4);
      line-height: 1.2;
    }
    
    .legacy-post-meta {
      color: var(--text-secondary);
      font-size: var(--text-sm);
      display: flex;
      justify-content: center;
      align-items: center;
      gap: var(--space-4);
      flex-wrap: wrap;
    }
    
    .legacy-post-date {
      background: var(--surface);
      padding: var(--space-2) var(--space-3);
      border-radius: 6px;
      font-weight: 500;
    }
    
    .legacy-post-category {
      background: var(--primary-color);
      color: white;
      padding: var(--space-2) var(--space-3);
      border-radius: 6px;
      font-weight: 500;
      text-transform: uppercase;
      font-size: var(--text-xs);
      letter-spacing: 0.5px;
    }
    
    .legacy-post-content {
      line-height: 1.8;
      color: var(--text-primary);
      font-size: var(--text-base);
    }
    
    .legacy-post-content h1,
    .legacy-post-content h2,
    .legacy-post-content h3,
    .legacy-post-content h4 {
      color: var(--text-primary);
      margin-top: var(--space-8);
      margin-bottom: var(--space-4);
      font-weight: 600;
    }
    
    .legacy-post-content h1 { font-size: var(--text-2xl); }
    .legacy-post-content h2 { font-size: var(--text-xl); }
    .legacy-post-content h3 { font-size: var(--text-lg); }
    .legacy-post-content h4 { font-size: var(--text-base); }
    
    .legacy-post-content p {
      margin-bottom: var(--space-4);
    }
    
    .legacy-post-content ul,
    .legacy-post-content ol {
      margin-bottom: var(--space-4);
      padding-left: var(--space-6);
    }
    
    .legacy-post-content li {
      margin-bottom: var(--space-2);
    }
    
    .legacy-post-content code {
      background: var(--surface);
      color: var(--primary-color);
      padding: var(--space-1) var(--space-2);
      border-radius: 4px;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
      font-size: var(--text-sm);
    }
    
    .legacy-post-content pre {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: var(--space-4);
      overflow-x: auto;
      margin: var(--space-6) 0;
    }
    
    .legacy-post-content pre code {
      background: none;
      padding: 0;
      color: var(--text-primary);
    }
    
    .legacy-post-content blockquote {
      border-left: 4px solid var(--primary-color);
      padding-left: var(--space-4);
      margin: var(--space-6) 0;
      font-style: italic;
      color: var(--text-secondary);
    }
    
    .legacy-post-content a {
      color: var(--primary-color);
      text-decoration: none;
      transition: color var(--transition-fast);
    }
    
    .legacy-post-content a:hover {
      color: var(--primary-dark);
      text-decoration: underline;
    }
    
    .legacy-post-content img {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
      margin: var(--space-4) 0;
    }
    
    .legacy-post-content .separator {
      clear: both;
      margin: var(--space-4) 0;
    }
    
    .legacy-post-content .gist {
      margin: var(--space-4) 0;
    }
    
    .legacy-post-content table {
      width: 100%;
      border-collapse: collapse;
      margin: var(--space-6) 0;
    }
    
    .legacy-post-content th,
    .legacy-post-content td {
      padding: var(--space-2) var(--space-3);
      text-align: left;
      border-bottom: 1px solid var(--border);
    }
    
    .legacy-post-content th {
      background: var(--surface);
      font-weight: 600;
    }
    
    .legacy-post-content strong,
    .legacy-post-content b {
      font-weight: 600;
      color: var(--text-primary);
    }
    
    .legacy-post-content em,
    .legacy-post-content i {
      font-style: italic;
    }
    
      background: var(--primary-color);
      color: white;
      padding: 2px 4px;
      border-radius: 3px;
      font-size: var(--text-sm);
    }
    
    @media (max-width: 768px) {
      .legacy-post-container {
        padding: var(--space-4);
        margin: var(--space-4);
      }
      
      .legacy-post-title {
        font-size: var(--text-2xl);
      }
      
      .legacy-post-meta {
        flex-direction: column;
        gap: var(--space-2);
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img src="../../assets/julien.webp" alt="Julien Simon" class="profile-image">
      <h1>Julien Simon</h1>
      <p class="title">Chief Evangelist @ Arcee AI</p>
      <p class="subtitle">World Expert in Practical AI</p>
    </header>

    <main>
      <article class="legacy-post-container">
        <header class="legacy-post-header">
          <h1 class="legacy-post-title">The Billion Dollar App Part 1</h1>
          <div class="legacy-post-meta">
            <span class="legacy-post-date">July 29, 2013</span>
            <span class="legacy-post-category">Cloud & AWS</span>
          </div>
        </header>
        
        <div class="legacy-post-content">
          Today, I'd like to show you how to build a basic web app running on EC2 and connecting to a MongoDB instance running on MongoLab. <a href="2013-07-25-from-one-cloud-to-the-next.html">We used Python so far</a>, so why not use Node.js this time around: Javascript and JSON should work with MongoDB, huh?<br />
<br />
We'll start from the same Ubuntu VM running in EC2. Only a little bit of extra setup is required.<br />
<br />
First, make sure you open a port for your web app (say, 8080): in the AWS console, go to the "<i>Security group</i>" section and add a custom rule opening port 8080/TCP. Don't forget to click on "<i>Apply rules changes</i>" ;) No need to restart your VM, the change is effective immediately.<br />
<br />
Then, '<i>ssh</i>' into to your VM and install the packages required by Node.js: the environment itself plus its package manager:<br />
<br />
<span>ubuntu@ip-10-48-45-182:~$&nbsp;<b>sudo apt-get install nodejs npm<br />
<br />
Now, let's install the <a href="http://github.com/mongodb/node-mongodb-native">native MongoDB</a> driver used by Node.js:<br />
<br />
<span>ubuntu@ip-10-48-45-182:~$&nbsp;<b>npm install mongodb<br />
<br />
This generated errors on Ubuntu 12.04, but the package still got installed. YMMV.<br />
<br />
All right, now to the good stuff. Here's our web server in Node.js:<br />
<ul>
<li>connect to our MongoDB instance (once again, make sure you use your own URI, username and password). Then, select '<i>collection1</i>', containing 25 documents (<i>{"_id", "x"}</i>)</li>
<li>create a web server running on port 8080 and wait for incoming requests: they will be served by the <i>onRequest</i> function, which issues a global <i>find()</i> on the collection and prints out all documents. <i>JSON.stringify()</i> is a life-saving browser function, it should hopefully work everywhere. If not, use Chrome ;)
<div>
Everything will run asynchronously, which is pretty much the point of Node.js, but this is out of scope for today. I strongly recommend the <a href="http://www.nodebeginner.org/">Node Beginner website</a> if you'd like to know more.</div>
<br />
<textarea cols="80" rows="32">// www.js
var http = require("http");
var MongoClient = require('mongodb').MongoClient;
var c;
function onRequest(request, response) {
  console.log("Request received");
  c.find().toArray(function (err, items) {
        response.writeHead(200, {"Content-Type": "text/html"});
        response.write("<HTML>");
        for (var i = 0; i < items.length; i++) {
                response.write(JSON.stringify(items[i])+"<br>");
        }
        response.write("</HTML>");
        response.end();
  });
}
MongoClient.connect("mongodb://USER:PWD@ds051067.mongolab.com:51067/mongolab-test", function(err, db) {
        if (!err) {
                console.log("Connected to database");
                c = db.collection("collection1");
        }
        else {
                console.log("Dude, where's my DB?");
        }
});
http.createServer(onRequest).listen(8080);
console.log("Web server started");
</textarea>
<br />
<div>
<div>
Pretty cool, yeah? Let's start this program on our VM:<br />
<br />
<span>ubuntu@ip-10-48-45-182:~$&nbsp;<b>node www.js<br />
<span>Web server started</span><br />
<span>Connected to database</span><br />
<br />
Our web server is now running. Yes, really. Now, let's connect to our instance from another machine. I'll use '<i>curl</i>' but your web browser will work too (feel free to actually try, my VM may be running):<br />
<br />
<span>$ <b>curl http://ec2-54-216-192-183.eu-west-1.compute.amazonaws.com:8080/<br />
<textarea cols="50" rows="30"><HTML>
{"_id":"51e3ce08915082db3df32bf0","x":1}<br />
{"_id":"51e3ce08915082db3df32bf1","x":2}<br />
{"_id":"51e3ce08915082db3df32bf2","x":3}<br />
{"_id":"51e3ce08915082db3df32bf3","x":4}<br />
{"_id":"51e3ce08915082db3df32bf4","x":5}<br />
{"_id":"51e3ce08915082db3df32bf5","x":6}<br />
{"_id":"51e3ce08915082db3df32bf6","x":7}<br />
{"_id":"51e3ce08915082db3df32bf7","x":8}<br />
{"_id":"51e3ce08915082db3df32bf8","x":9}<br />
{"_id":"51e3ce08915082db3df32bf9","x":10}<br />
{"_id":"51e3ce08915082db3df32bfa","x":11}<br />
{"_id":"51e3ce08915082db3df32bfb","x":12}<br />
{"_id":"51e3ce08915082db3df32bfc","x":13}<br />
{"_id":"51e3ce08915082db3df32bfd","x":14}<br />
{"_id":"51e3ce08915082db3df32bfe","x":15}<br />
{"_id":"51e3ce08915082db3df32bff","x":16}<br />
{"_id":"51e3ce08915082db3df32c00","x":17}<br />
{"_id":"51e3ce08915082db3df32c01","x":18}<br />
{"_id":"51e3ce08915082db3df32c02","x":19}<br />
{"_id":"51e3ce08915082db3df32c03","x":20}<br />
{"_id":"51e3ce08915082db3df32c04","x":21}<br />
{"_id":"51e3ce08915082db3df32c05","x":22}<br />
{"_id":"51e3ce08915082db3df32c06","x":23}<br />
{"_id":"51e3ce08915082db3df32c07","x":24}<br />
{"_id":"51e3ce08915082db3df32c08","x":25}
</textarea>
</div>
<br />
And this, ladies and gentlemen, is a super scalable, state of the hype, cloud-based web application. Anybody wants to buy it for a billion dollars? :D<br />
<br />
Until next time, read, learn and write some code!
        </div>
      </article>
    </main>

    <footer>
      <nav>
        <a href="../../index.html">Home</a>
        <a href="../../experience.html">Experience</a>
        <a href="../../publications.html">Publications</a>
        <a href="../../code.html">Code</a>
        <a href="../../books.html">Books</a>
        <a href="../../youtube.html">YouTube</a>
        <a href="../../computers.html">Computers</a>
        <a href="../../legacy-posts.html">Legacy Posts</a>
      </nav>
    </footer>
  </div>

  <script src="../../js/main.js"></script>
</body>
</html>