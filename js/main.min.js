'use strict';class PerformanceMonitor{constructor(){this.metrics ={};this.initObservers();this.initWebVitals()}initObservers(){if ('PerformanceObserver' in window){try{const lcpObserver = new PerformanceObserver((list) =>{const entries = list.getEntries();const lastEntry = entries[entries.length - 1];this.metrics.lcp = Math.round(lastEntry.startTime);this.trackMetric('LCP',this.metrics.lcp)});lcpObserver.observe({entryTypes:['largest-contentful-paint']});const fidObserver = new PerformanceObserver((list) =>{const entries = list.getEntries();entries.forEach(entry =>{this.metrics.fid = Math.round(entry.processingStart - entry.startTime);this.trackMetric('FID',this.metrics.fid)})});fidObserver.observe({entryTypes:['first-input']});const clsObserver = new PerformanceObserver((list) =>{let clsValue = 0;const entries = list.getEntries();entries.forEach(entry =>{if (!entry.hadRecentInput){clsValue += entry.value}});this.metrics.cls = Math.round(clsValue * 1000) / 1000;this.trackMetric('CLS',this.metrics.cls)});clsObserver.observe({entryTypes:['layout-shift']});const inpObserver = new PerformanceObserver((list) =>{const entries = list.getEntries();entries.forEach(entry =>{if (entry.interactionId){this.metrics.inp = Math.round(entry.processingStart - entry.startTime);this.trackMetric('INP',this.metrics.inp)}})});inpObserver.observe({entryTypes:['interaction']})}catch (e){console.warn('Performance monitoring not supported:',e)}}}initWebVitals(){window.addEventListener('load',() =>{setTimeout(() =>{const navigation = performance.getEntriesByType('navigation')[0];if (navigation){this.trackMetric('DOMContentLoaded',Math.round(navigation.domContentLoadedEventEnd - navigation.domContentLoadedEventStart));this.trackMetric('LoadComplete',Math.round(navigation.loadEventEnd - navigation.loadEventStart));this.trackMetric('TotalLoadTime',Math.round(navigation.loadEventEnd - navigation.fetchStart))}},0)})}trackMetric(name,value){if (typeof umami !== 'undefined'){umami.track('web_vital',{metric:name,value:value,page:window.location.pathname,timestamp:Date.now()})}if (window.location.hostname === 'localhost'){console.log(`ðŸ“Š ${name}:${value}`)}try{const stored = JSON.parse(localStorage.getItem('performance_metrics') || '{}');stored[name] = value;localStorage.setItem('performance_metrics',JSON.stringify(stored))}catch (e){}}}class LazyLoader{constructor(){this.images = document.querySelectorAll('img[loading="lazy"]');this.init()}init(){if (!('IntersectionObserver' in window) || this.images.length === 0) return;const imageObserver = new IntersectionObserver((entries,observer) =>{entries.forEach(entry =>{if (entry.isIntersecting){this.loadImage(entry.target);observer.unobserve(entry.target)}})},{rootMargin:'50px 0px',threshold:0.01});this.images.forEach(img => imageObserver.observe(img))}loadImage(img){const src = img.dataset.src || img.src;if (!src) return;const tempImg = new Image();tempImg.onload = () =>{img.src = src;img.classList.add('loaded');img.removeAttribute('data-src');if (typeof umami !== 'undefined'){umami.track('image_loaded',{src:src,page:window.location.pathname})}};tempImg.onerror = () =>{console.warn('Failed to load image:',src);img.classList.add('error');if (typeof umami !== 'undefined'){umami.track('image_error',{src:src,page:window.location.pathname})}};tempImg.src = src}}class Navigation{constructor(){this.init()}init(){this.highlightCurrentPage();this.initSmoothScrolling();this.initAnalytics();this.initKeyboardNavigation()}highlightCurrentPage(){const currentPage = window.location.pathname.split('/').pop() || 'index.html';const navTabs = document.querySelectorAll('.nav-tab');navTabs.forEach(tab =>{const href = tab.getAttribute('href');if (href === currentPage){tab.classList.add('active')}})}initSmoothScrolling(){const links = document.querySelectorAll('a[href^="#"]');links.forEach(link =>{link.addEventListener('click',(e) =>{e.preventDefault();const targetId = link.getAttribute('href').substring(1);const targetElement = document.getElementById(targetId);if (targetElement){targetElement.scrollIntoView({behavior:'smooth',block:'start'});history.pushState(null,null,`#${targetId}`);if (typeof umami !== 'undefined'){umami.track('internal_link_click',{target:targetId,page:window.location.pathname})}}})})}initKeyboardNavigation(){document.addEventListener('keydown',(e) =>{if (e.key === 'Tab'){document.body.classList.add('keyboard-navigation')}});document.addEventListener('mousedown',() =>{document.body.classList.remove('keyboard-navigation')})}initAnalytics(){if (typeof umami !== 'undefined'){umami.track('page_view',{page:window.location.pathname,title:document.title,referrer:document.referrer,userAgent:navigator.userAgent,viewport:`${window.innerWidth}x${window.innerHeight}`})}const externalLinks = document.querySelectorAll('a[href^="http"]');externalLinks.forEach(link =>{link.addEventListener('click',() =>{if (typeof umami !== 'undefined'){umami.track('external_link_click',{url:link.href,text:link.textContent.trim(),page:window.location.pathname,target:link.target || '_self'})}})});const forms = document.querySelectorAll('form');forms.forEach(form =>{form.addEventListener('submit',() =>{if (typeof umami !== 'undefined'){umami.track('form_submit',{form:form.id || form.className,page:window.location.pathname})}})})}}class ErrorMonitor{constructor(){this.init()}init(){window.addEventListener('error',(e) =>{this.trackError('JavaScript Error',e.error || e.message,e.filename,e.lineno)});window.addEventListener('unhandledrejection',(e) =>{this.trackError('Unhandled Promise Rejection',e.reason,'',0)})}trackError(type,message,filename,lineno){if (typeof umami !== 'undefined'){umami.track('error',{type:type,message:message,filename:filename,lineno:lineno,page:window.location.pathname,userAgent:navigator.userAgent})}console.error(`ðŸš¨ ${type}:`,message,filename,lineno)}}const utils ={debounce(func,wait){let timeout;return function executedFunction(...args){const later = () =>{clearTimeout(timeout);func(...args)};clearTimeout(timeout);timeout = setTimeout(later,wait)}},throttle(func,limit){let inThrottle;return function(){const args = arguments;const context = this;if (!inThrottle){func.apply(context,args);inThrottle = true;setTimeout(() => inThrottle = false,limit)}}},async fetchWithTimeout(url,options ={}){const{timeout = 5000,...fetchOptions}= options;const controller = new AbortController();const timeoutId = setTimeout(() => controller.abort(),timeout);try{const response = await fetch(url,{...fetchOptions,signal:controller.signal});clearTimeout(timeoutId);return response}catch (error){clearTimeout(timeoutId);throw error}},async copyToClipboard(text){try{await navigator.clipboard.writeText(text);return true}catch (err){const textArea = document.createElement('textarea');textArea.value = text;document.body.appendChild(textArea);textArea.select();document.execCommand('copy');document.body.removeChild(textArea);return true}},getDeviceType(){const ua = navigator.userAgent;if (/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(ua)){return 'tablet'}if (/mobile|android|iphone|ipod|blackberry|opera mini|iemobile/i.test(ua)){return 'mobile'}return 'desktop'}};document.addEventListener('DOMContentLoaded',() =>{window.performanceMonitor = new PerformanceMonitor();window.lazyLoader = new LazyLoader();window.navigation = new Navigation();window.errorMonitor = new ErrorMonitor();if (window.location.hostname === 'localhost'){window.utils = utils}if (typeof umami !== 'undefined'){umami.track('page_loaded',{page:window.location.pathname,loadTime:performance.now(),deviceType:utils.getDeviceType()})}});if ('serviceWorker' in navigator){window.addEventListener('load',() =>{navigator.serviceWorker.register('/sw.js') .then(registration =>{console.log('SW registered:',registration)}) .catch(registrationError =>{console.log('SW registration failed:',registrationError)})})}